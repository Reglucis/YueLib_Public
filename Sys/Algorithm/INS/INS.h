/*****************************************************************************************************
 * @file		
 * @author		Reglucis
 * @version		V0.1
 * @date		
 * @brief		
 * @email		Reglucis@outlook.com	
 ****************************************************************************************************
 * @details 	
 * 			
 * 		
 ***************************************************************************************************/

#ifndef __INS_H__
#define __INS_H__

#include "stm32f4xx_hal.h"

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////// ⬇ ⬇ ⬇ ⬇ ⬇ ⬇ ////    配  置  区    //// ⬇ ⬇ ⬇ ⬇ ⬇ ⬇ ///////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#include "./Sys/Algorithm/INS/INS.h"
#include "./Components/BMI088/Core/BMI088driver.h"
#include "./Sys/Algorithm/KF/QuaternionEKF.h"
#include "./Sys/DWT/DWT.h"
#include "./Sys/Math/MyMathLib.h"




///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////// ⬇ ⬇ ⬇ ⬇ ⬇ ⬇ ////  非  配  置  区  //// ⬇ ⬇ ⬇ ⬇ ⬇ ⬇ ///////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/*------------------------------------------------------------ 变量类型 ------------------------------------------------------------*/
typedef struct {
	float q[4]; // 四元数估计值

	float MotionAccel_b[3]; // 机体坐标加速度
	float MotionAccel_n[3]; // 绝对系加速度
	float gravity[3];
	float AccelLPF; // 加速度低通滤波系数
	// 位姿
	float Roll;
	float Pitch;
	float Yaw;
	float YawTotalAngle;
	
	QEKF_INS_t* QEKF;
	DWT_Stopwatch_t Stopwatch;
} INS_t;


INS_t* INS_New(float* gravityVec, float accelLPF, double phi);
void INS_update(INS_t* ins, IMU_t* imu);
/*------------------------------------------------------------ 函数声明 ------------------------------------------------------------*/

#endif
